<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Outreach Prague team</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="tiles.js"></script>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">

        function Avatar({ person }) {
            const src = "https://ca.slack-edge.com/T02UUSZ58-" + person.id + "-42";
            const className = person.isEM ? 'em' : person.isPM ? 'pm' : person.isDSG ? 'dsg' : person.isCON ? 'con' : '';
            const url = "https://app.slack.com/client/T02UUSZ58/C02UUSZ5G/user_profile/" + person.id.split('-')[0];

            return (
                <div className={"avatar " + className} onClick={() => window.open(url, '_blank')}>
                    <img src={src} />
                    <span className="name">{person.name}</span>
                </div>
            );
        }

        function Section({ section, showCharter }) {
            const url = 'https://outreach-io.atlassian.net/wiki/spaces/' + section.key + '/overview';

            return (
                <div className="left">
                    {section.key ? <div title={url} className='subtitle active' onClick={() => window.open(url, '_blank')}>{section.name}</div> :
                        <div className='subtitle'>{section.name}</div>
                    }
                    {section.people.map(person => <Avatar person={person} key={person.name} />)}
                </div>
            );
        }

        function Tile({ tile }) {
            const hasMultipleSections = tile.sections.length > 1;
            const url = 'https://outreach-io.atlassian.net/wiki/spaces/' + tile.key + '/overview';

            return (
                <div className={hasMultipleSections ? 'tile multiple' : 'tile'}>
                    {tile.key ? <div title={url} className='title active' onClick={() => window.open(url, '_blank')}>{tile.name}</div> :
                        <div className='title'>{tile.name}</div>
                    }
                    <div className='body'>
                        {tile.sections.map(section => <Section showCharter={text => setText(text)} section={section} key={section.name || tile.name} />)}
                    </div>
                </div>
            );
        }

        function Tab({ onClick, selected, children }) {
            return <li className={selected ? 'selected' : ''} onClick={onClick}>{children}</li>;
        }

        function MyApp() {
            const [selectedIndex, setSelectedIndex] = React.useState(0);
            const [showRoles, setShowRoles] = React.useState(false);

            return <>
                <ul>
                    {tabs.map((tab, index) =>
                        <Tab key={index} onClick={() => setSelectedIndex(index)} selected={index === selectedIndex}>{tab.label}</Tab>)}
                    <li onClick={() => setShowRoles(!showRoles)}>Show roles <input type='checkbox' /></li>
                </ul>
                <div className={showRoles ? "SHOW-ROLES" : ""}>
                    {tabs[selectedIndex].tiles.map(tile => <Tile tile={tile} key={tile.name} />)}
                </div>
            </>;
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<MyApp />);

    </script>
</body>

</html>